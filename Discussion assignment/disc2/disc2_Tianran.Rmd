---
title: "Disc2_Tianran"
author: "Tianran Zhang"
date: "6/24/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)


library(ggdag)
library(dagitty)
```

# Study 1: Physical activity and mortality in the elderly
## Step 3: Observed data & link to causal model.
1. **Specify the observed data.**   
For the people involved in this study, their free-living activity energy expenditure over a two week period (A), their vital status (Y), and their medical consitions including smoking, comorbidities, and body fat (W) were documented as our observed data: $O = (W, A, Y)$. 

2. **What notation do we use to refer to the distribution of the observed data?**    
We refer to the distribution of the observed data with notation P: $O = (W, A, Y) \sim P$.    

3. **What is the link between the structural causal model (SCM) and the observed data?**    
The observed data were generated by sampling n independent times from a data generating system described by the structural causal model (SCM), which would yield n iid observations: $O_1, O_2, ..., O_n \ \ iid\ \ \sim P$.    

4. **What is the statistical model? Does the SCM place any restrictions on it?**   
The statistical model is the set of possible distributions for the observed data. The statistical model for the set of allowed observed data distributions is non-parametric.   
SCM does not place any restrictions on it.    

## Steps 4-5: Identifiability & Committing to a statistical estimand
5. **Assess the identifiability of θ∗ using the back-door criterion.**     
```{r}
dag <- dagify(Y ~ W + A + UY,
              A ~ W + UA,
              W ~ UW,
              exposure = "A",
              outcome = "Y")
tidy_dag <- tidy_dagitty(dag)

ggdag(tidy_dag, layout = "circle")
```

In the original SCM, the target causal parameter is not identified from the observed data distribution. Based on back-door criterion, W does not block all back door pathes from Y to A when there is no independence assumptions. For example, $Y \rightarrow U_Y \rightarrow U_A \rightarrow A$ is a possible back-door path. 

6. **If not identified, under what assumptions would it be? Are some of these sets of additional assumptions more plausible than others?**    
Additional assumptions: $U_A {\perp \!\!\! \perp} U_Y$ and (i) $U_A {\perp \!\!\! \perp} U_W$ OR (ii) $U_W {\perp \!\!\! \perp} U_Y$. Under the above assumptions, W would satisfy the backdoor criteria for indetifiability. We then have $A {\perp \!\!\! \perp} Y_a | W$.      
For a total of 3 sets of additional assumptions, (a) $U_A {\perp \!\!\! \perp} U_Y, \ U_A {\perp \!\!\! \perp} U_W$ and (b) $U_A {\perp \!\!\! \perp} U_Y, \ U_W {\perp \!\!\! \perp} U_Y$ are more plausible than (c) $U_A {\perp \!\!\! \perp} U_Y, \ U_A {\perp \!\!\! \perp} U_W, \ U_W {\perp \!\!\! \perp} U_Y$. Because the first two sets only have less additional assumptions (only 2) compared to the third one(which has 3 additional assumptions). 

7. **Are there additional measurements you could make so that the needed identifiability assumptions are more plausible?**      
We could adjust the protential common causes of A, Y, and W (age, gender and education) so that the needed additional assumptions are more possible to be satisfied, thus the identifiability assumptions are more plausible. 

8. **Specify the target parameter of the observed data distribution (i.e. the statistical estimand).**     
The target statistical parameter is given by the G-computation formula:  \[
\theta = E[E(Y|A = 1, W)] - E[E(Y|A = 0, W)] \\ = \sum_wE(Y|A = 1, W  =w)P(W = w) - \sum_wE(Y|A = 1, W  =w)P(W = w)\]

9. **In your opinion, what is the relevant positivity assumption? Are you concerned about violations of the positivity assumption in your study?**    
Positivity assumption:  
$$min_{a \in \{0, 1\}}P(A = a|W = w) > 0$$
for all w for which $P(W = w) > 0$. We need that each possible exposure level is represented in every covariate strata. This condition on data support ensures that our statistical estimand is well-defined. I am concerned about violations of the positivity assumption since there are many possible stratas for W but the sample size is small (with 302 individuls included in this study). Thus there might be only a few or no people have high (or low) energy expenditure within that strata. 

10. **Suppose the investigators assume no unmeasured common causes of (W,A,Y) is this necessary for identifiability? Is it sufficient?**     
This assumption is sufficient, but not necessary for identifiability. In fact, we only need assumptions that $U_A {\perp \!\!\! \perp} U_Y$ and (i) $U_A {\perp \!\!\! \perp} U_W$ OR (ii) $U_W {\perp \!\!\! \perp} U_Y$. Under either assumptions, our statistical estimand is identified.    


